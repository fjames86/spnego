
      
;; InitializeContextToken()
#(96 130  5 224  6  6 43  6  1  5  5  2 160 130  5 212 48
130  5 208 160 48 48 46  6  9 42 134 72 130 247 18  1
 2  2  6  9 42 134 72 134 247 18  1  2  2  6 10 43
 6  1  4  1 130 55  2  2 30  6 10 43  6  1  4  1
130 55  2  2 10 162 130  5 154  4 130  5 150 96 130  5
146  6  9 42 134 72 134 247 18  1  2  2  1  0 110 130
 5 129 48 130  5 125 160  3  2  1  5 161  3  2  1 14
162  7  3  5  0 32  0  0  0 163 130  4  7 97 130  4
 3 48 130  3 255 160  3  2  1  5 161 13 27 11 69 88
83 69 81 85 73 46 67 79 77 162 19 48 17 160  3  2
 1  1 161 10 48  8 27  6 102 106 97 109 101 115 163 130
 3 210 48 130  3 206 160  3  2  1 23 161  3  2  1  3
162 130  3 192  4 130  3 188 204 103 38 205 197 102 10 51
15 200  8 58 151 250 228 249 247  6 103 183 21 68 181 92
55 253 94 119 56 221 246 25 44 199 101 45 152 204 69 242
68 216 163 137 68 78 165 111 10 165  9 47 82 91 152 114
236 247 86 252 219 235 53 255 39 70 251 179 26 224 151 159
127 172 141 86 193 165 107 115 174 12 147 180 109 188 253 147
103 206 89 127 86 11 172 68 170 213 170 255 175 52 207 148
164 76 52 12 60 133 115  7 37 243 91 217 188 198 133 91
148 172 55 65 20 132 139 45 152 36 188 97 224 245 91 122
77 72 58 24 56 173 114 211 250 90 30 27 109 73  7 143
174 155 178 68 197 80 86 18 47 176 203 207  0 112 252 185
185 127 106 122 48 12 57 33 102 193 245 97 198 235 138 252
164 255 161 250 211 18  6 88 25 164 195 20 141 177 202 254
85 245 171 43 159 87 188 133 200 25 188 167  0 105 122 245
232 222 76 100 18 222 63 20 99 252 91 127 212 66 82 234
234 158 124 234 147 146 122 65 37 242 27 228 28 80 226 94
196 42 240 97 55 40 192 54 179 65 216 183 70 226 13 47
108 137 185 114 43 119 199 226 40 32 99 70 97 124 120 80
143 47 102 164 198 242 253 71 218 93 11 226 206 112 126 153
134 13 87 233 12 58 44 19 125 58 85 145 56 46 109 215
206 59 39 64 61 178 230 55 82 249 70 48 246 131 30 251
80 85 113 254 67 72 170 191 54 169 204 50 105 144 17 55
53 108 145 74 198 128 245 157 98 211 100 190 72 131 98 175
92 107  5 128 14 200 202 190 38 45 106 180 80 197 23 180
69 189 29 176 229 247 94 183 110 191 29 112 74 55 184 210
63 110 174 240 21 239 30 181 180 95 211 209 221 150 77 77
111 59 247 188 83 25 209 163 237 168 48 56 49 110 62 29
43 191 186 84 183 214 220 45 43 150 131 88 60 31 69  2
236 19 52 56  1 162 217 157 107 173 47 68 139 184  0 202
133 91 146 215 49 170 252 72 120 152 231 34 221 13 55 252
239 23 219 43 216 179 87 25 45 150 22 107 116 235 133 96
90 114 171 135 41 197 161 187 229 25 97 104 209 170 169 125
139 126  1 153 201 15 103 202 196 239 54  7 219  9 101 23
28 159 147 198  2 100 120 188 95 230 59 70 166 223 217 167
253 31  6 171 95 148 191 229 37 209 109 214 28 233 79 114
62 116 19 121 46 48 57 24  4 130 24 218 191 212 242 156
13 23 144 55 194 96 116 59 18 132 14 163 158 93 192 42
251 81 160 106 110 221 101 128 50 34 209 88 156 145 182 71
112 209 85 169 132 185 87 16 19 214 101 11 68 96 72 170
143 148 221 60 201 39 246 235 214 78 250 33 35 37 141 90
81 245 53 126  5 99 60 68 90 189 103 13 80 94  3 133
197 235 195 100 143 139 84  2 91 112  7 11 208 243 242 57
242 157 102 120 103 73 244 39  1 226 15 181 130 212 81 215
34 159 125 115 126 97 198 83 79 37 41 121 16 179 163 139
237 202 129 39 125 218 192 54 221 254 187 46 181 18 78 244
51 145 100 10 93 248 48 14 118 158 62 17 13 86 232 89
104 228 243 11 28 201 91 196 121 40 20 233 223 77 123 194
103 216 138 144 223 98  1 91 220 79 61 176 53 12 126 144
 0 242 231 217 22 103 43 99 59 93 186 232 220  5 124 212
 0 113 229 104 211 233 166 94 192 242 99 150 125 109  5 201
174 161 186 140 120 229 215 118  7  2 150 113 176 190 207 28
129 56 209 108 235 41 133 30 189 54 182 107 33 241 15 90
164 90 90 135 249 49  8 111 225 194 40 153 170 241 41 82
173 44 154 206 254 30 102 177 25 202  8 246 30 97 187 248
42 108 90 47 92 172 155 102 250 32 255 227 81 216 223 104
216 41 247 191 106 28 46 173 168 151 55 222 110 60 204 167
174 94 206 46 70 10 238 172 36 32 137 131 80 74 152 204
128 142 44 101 205 112 84 236 215 187 101 29 50 49 96 140
155 253 95 104 39 56 90 126 201 162 154 22 90 195 231  5
10 32 97 94 253 179 16 241 158 210 28 252 130 120 225 228
150  1 73 50 164 130  1 91 48 130  1 87 160  3  2  1
23 162 130  1 78  4 130  1 74 164 82 51 109 208 34 238
179 86 238 223 23 138 248 228 15 80 207 243 214 172 224 14
133 250 118 90 10 212 225 187 148 220 61 167 59 63 144 57
239 55 151 32 228 110 12 161 175 200 221 148 154 195 201 186
74 41 238 45 85 36 214 238 100 223 147 139  6 145 238  0
214 179 30 91 31  7 208 94 108 254 213 76 202 31 180 145
241 35 46 104 222  4 98 106 249 182 28 250 151 220 25 183
216 103  3 248 209 217 39 149 135 231 56 107 51 125 47 220
184 184 140 168 63 200 178 223 187 95 203 224 235 54 143 198
83 185 14 87  2 41 22 184 53 29 230 71  0 31 210 244
114 215 164 74 14 159 184 217 224 74 214 98 30 202 156 20
153 248 15 238 100 206 119 204 79 91 39 73 220 149 158  4
162 42 123 70 230 212 194 89 39 36 181 41 111 83 209 171
241 227 164 181 208 124  6 12 19 128 89 72 220 183 20  5
 0 251 174 45 81 118 53 137 130 248 89 84 149 189 114 130
 7 245 246 96 82 213 27 245 250 22  1 241 104 247 58 211
47 99 250 99 144 107 13 47 205 184 231 92 184 245 242 201
170 132 177 85 64 116 152 86 224 26 72 193 10 150  8 75
 7 83 184 84 238 180 16 129 97 82 11 80 94 161 234 64
18 218 135 229 105 156 215 10 216 194 164 218  6 242 231 142
143 222 112 208 220 31 10 137 242 242 105 236 132 188 231 116
220 71 210)

;; --> spnego-oid wrapping a neg-token-init with a standard Kerberos GSS AP-REQ token
;; (unpack #'decode-nego-token (unpack #'decode-initial-context-token *))


;; accept context token
#(161 120 48 118 160  3 10  1  1 161 11  6  9 42 134 72 130
247 18  1  2  2 162 98  4 96 96 94  6  9 42 134 72
134 247 18  1  2  2  3  0 126 79 48 77 160  3  2  1
 5 161  3  2  1 30 164 17 24 15 50 48 49 53 48 54
49 49 49 51 52 56 50 49 90 165  5  2  3  1 138 68
166  3  2  1 41 169 13 27 11 69 88 83 69 81 85 73
46 67 79 77 170 19 48 17 160  3  2  1  1 161 10 48
 8 27  6 102 106 97 109 101 115)

;; neg-token-resp containing a krb-error :modified token (!)
;; (unpack #'decode-nego-token *)

;; initializecontexttoken
#(161 130  5 167 48 130  5 163 160  3 10  1  1 162 130  5 154
 4 130  5 150 96 130  5 146  6  9 42 134 72 134 247 18
 1  2  2  1  0 110 130  5 129 48 130  5 125 160  3  2
 1  5 161  3  2  1 14 162  7  3  5  0 32  0  0  0
163 130  4  7 97 130  4  3 48 130  3 255 160  3  2  1
 5 161 13 27 11 69 88 83 69 81 85 73 46 67 79 77
162 19 48 17 160  3  2  1  1 161 10 48  8 27  6 102
106 97 109 101 115 163 130  3 210 48 130  3 206 160  3  2
 1 23 161  3  2  1  3 162 130  3 192  4 130  3 188 191
56 247  8 52 79 185 186 135 248  4 235 241 148 58 47 139
230 132 225 243 206 31 159  4 129  1 61 13 151 114 19 72
99  4 19 251 243 152 81 111  3 58 138 83 223 36 232 145
248  3 82 76 253 222 93 107 197 137 151 79 183 15 179 78
208 212 101 80 85 199 57 237 20 98 199 122 148 188 88 251
111 249 57 255 251 238  6 148 82 232 84 194 114 128  6 119
107 242 185 145 102 138 15 12 18 69 212 106 206 220 32 175
94 181 65 124 248 199 237 194 241 100 85 255 92 109 69 106
121 166 111 120 219 183 91 97 154 163  4 154 229 224 57 197
54 39 115 178 186  1 150 214 163 204 252 225 229 160  1 174
14 235  1 72 139 131 216 164 50 100 245 212 164 22 76 197
169 114 78 130 250 147 66 69 225 247 136 198 165 44 113 201
17 122 17 14 93 227 130 125 91 30 93 177 161 24 160 196
222 202 100 161 67 15 116 65 154 77 72 200 215 221 109 133
23 16 48 217 142 149 249 92 156 160 60 68 169 60 45 178
224 148 250 124 225 73 251 10 59 217 107 218 88 240 43 145
247 46 251 196 83 42 145 125 205 117 213 134  7 76 232 147
 3 140 139  5 180 142  7 186 203 220 68 13 45 90 130 174
90 135  4 165  9 229 214 18 121 56 140 242  3 171 162 229
243 221 127 115 170 242 135 109  8 104 119 235 47 115 238 88
140 186 26 204 61 162 112 140 238 193 33 228 168 150 172 246
253 115 15 149 203 155 84 32 87 235 85 68 159 26 142 38
92 192 242 133 141 254 129 39 146 61 35 51 97 182 101 167
41 250 126 210 231 225 10 80 17 113 23 180 33  1 49 54
159 175 47 154 54 243 175 106 192 135 26 18 246 68 43 89
95 236 41 39 150 204 61 156 154 198 169 128 101 203 73 199
80 234 39 79 34 92 158 233 104  1 159 94 11 67 135 161
36 115 30 41 44 175 34 57 153 250 222 126 164 84 20 155
40 32 171  4 11 224 90 191 29 201 97 115 41 205 243 222
 3 59 138 96 34 223 140 151 48 165 82 151 99 49 198 102
213 70 155 210 156 27 68 84 72 64 221 22 148 211 161 128
172 171 126 91 187 228 64 174  4 164 17 217 231 86  3 223
241 74 193 133 47 26 245 185 136 212 119 100 89 57 183 169
146 27 181 246 70 134 112 116 36 69 215 100 31 47 100 139
161 111 91 43 125 202 198 97 180 135 226 190 191 17 17 249
 3 33 223 58 160 101 172 209 12 47 23 136 31 165 182 144
207 174 222 21 209 68 49 245 150  6 137 214 162 218 85 85
107 157 160 123 112 252 55 145 166 242 116 82 27 32 197 114
168 126 106  3 43 195 28 233 177 67 228 126 232 22 41 25
27 177 37 13 108 94 101 102 104 149 69 87 163 42 96 159
222 250 122 162 168 62 101 11 113 147 121 149 99 244 212 10
92 63 101 214 181 51  4 206 205 86 130 42 36 254 229 93
210 60 109 107 162 183  4 73 137 73 249  9  1 205 212 127
148 191 139 120  1 37 81 72 133 56 205 97 146 146 182 105
252 147 108 217 132 240 235 57 255 67 35 232 52 67  1 32
181 18 150 107 208 249 164 90 196 240 124 109 212 100 74 85
79 212 125 78 55 234 219 81 223 130 99 234 90 145 102 171
142 226 150 27 225 14 39 27 154 52 180 132 31 109 122 183
245 57 145 57 228 55 228 147 243 151 204 99 109 171 243 53
20 58 183 108 178 79 166 193 193 170 122 186 72 177 217 110
 7 238 145 80 42 62 74 61 183 136 183 219 163 118 113 20
 0 26 68 123 134 156 233 89 133 111 249 105 84  6 26 50
171 119 236 229 204 89 206 82  5 168 208 39 213 229  9 23
252 79 194 247 101 82 39 190 247 85 251 184 251 174 90 92
41 218 173 146 68 107 68 218 71 194 101  0 74  1 105 63
206 63 54  8 27 19 255 58 237  5 13 91 33 215 62 10
178 138 133 26 104 42 70 91 121 254 101 108 117 116 48 86
126 72 132 59 40 105  9 179 247 132 59 52 29 29 151 129
228 70 172 130 73 22 68 41 44 235 51 112 207 135 205 247
149 131 211 231 75 217 27 170 140 69 41 164 130  1 91 48
130  1 87 160  3  2  1 23 162 130  1 78  4 130  1 74
103  5 144 127 198 166 76 134 199 196 117 113 117 252 210 207
252 171 117 128 162 176 211 28 149 137 168 121 204 146 150 47
77 144 61 201 192 32 19 37 114 49 13 63 75 211 158 159
53 77 66 254 254 241 212 33 205 254 164 117 188 199 182 96
207 126 250 70 68 163 75 74 225 202 223 128 122 166 198 26
58 23 247 230 239 252 43 203 208 20 202 230 61 135 127 99
187 222 44 123 237 101 38 183 127 63 228 14 243 16 209 126
206 22 150 78 41 115 236 85 61 237 85 125 10 81 204 150
202  9 136 115 197 107 139 190 115 219 164 243 150 17 73 22
218 226 128 52 134 249 253 16 138 233 90 149 141 151 170 234
102 62 54 27 149 73 148 140 27 12 11 32 223 17 182 134
184 212 252 53 160 215 93 110 185 35 34 11 179 238 181 108
99 224 108 221 240 187 42 139 130 53 200 236 95 223 91 66
137 166 44 156 253 126 238 213 217 14 119 79 203 85 156 71
40 254 146 15 10 72 115 41 197 188 250 167 62 191 41 145
247 28 112 210 253 241 28 188 37 239 15 34 191 205 215 129
228 18 250 102 114 18 30 206 22 27 35 45 149 111 168 208
77 71 132 253 209 49 37  6 191 208 107 243 100 224 250 228
39 134 29 102 75 35 198 174 227 83 70 248 221 70 156 237
151 97 89 206 153 236 239 158 28 166 109 185 111 180 109 236
183 152 199 251 39 115 109 141 232 79)

;; neg-token-resp containing the same original kerberos AP-REQ token
;; (unpack #'decode-nego-token *)

#S(CERBERUS::AP-REQ
   :PVNO 5
   :TYPE 14
   :OPTIONS (:MUTUAL-REQUIRED)
   :TICKET #S(CERBERUS::TICKET
              :VNO 5
              :REALM "EXSEQUI.COM"
              :SNAME #S(CERBERUS::PRINCIPAL-NAME
                        :TYPE :PRINCIPAL
                        :NAME ("fjames"))
              :ENC-PART #S(CERBERUS::ENCRYPTED-DATA
                           :TYPE :RC4-HMAC
                           :KVNO 3
                           :CIPHER #(191 56 247 8 52 79 185 186 135 248 4 235
                                     241 148 58 47 139 230 132 225 243 206 31
                                     159 4 129 1 61 13 151 114 19 72 99 4 19
                                     251 243 152 81 111 3 58 138 83 223 36 232
                                     145 248 3 82 76 253 222 93 107 197 137 151
                                     79 183 15 179 78 208 212 101 80 85 199 57
                                     237 20 98 199 122 148 188 88 251 111 249
                                     57 255 251 238 6 148 82 232 84 194 114 128
                                     6 119 107 242 185 145 102 138 15 12 18 69
                                     212 106 206 220 32 175 94 181 65 124 248
                                     199 237 194 241 100 85 255 92 109 69 106
                                     121 166 111 120 219 183 91 97 154 163 4
                                     154 229 224 57 197 54 39 115 178 186 1 150
                                     214 163 204 252 225 229 160 1 174 14 235 1
                                     72 139 131 216 164 50 100 245 212 164 22
                                     76 197 169 114 78 130 250 147 66 69 225
                                     247 136 198 165 44 113 201 17 122 17 14 93
                                     227 130 125 91 30 93 177 161 24 160 196
                                     222 202 100 161 67 15 116 65 154 77 72 200
                                     215 221 109 133 23 16 48 217 142 149 249
                                     92 156 160 60 68 169 60 45 178 224 148 250
                                     124 225 73 251 10 59 217 107 218 88 240 43
                                     145 247 46 251 196 83 42 145 125 205 117
                                     213 134 7 76 232 147 3 140 139 5 180 142 7
                                     186 203 220 68 13 45 90 130 174 90 135 4
                                     165 9 229 214 18 121 56 140 242 3 171 162
                                     229 243 221 127 115 170 242 135 109 8 104
                                     119 235 47 115 238 88 140 186 26 204 61
                                     162 112 140 238 193 33 228 168 150 172 246
                                     253 115 15 149 203 155 84 32 87 235 85 68
                                     159 26 142 38 92 192 242 133 141 254 129
                                     39 146 61 35 51 97 182 101 167 41 250 126
                                     210 231 225 10 80 17 113 23 180 33 1 49 54
                                     159 175 47 154 54 243 175 106 192 135 26
                                     18 246 68 43 89 95 236 41 39 150 204 61
                                     156 154 198 169 128 101 203 73 199 80 234
                                     39 79 34 92 158 233 104 1 159 94 11 67 135
                                     161 36 115 30 41 44 175 34 57 153 250 222
                                     126 164 84 20 155 40 32 171 4 11 224 90
                                     191 29 201 97 115 41 205 243 222 3 59 138
                                     96 34 223 140 151 48 165 82 151 99 49 198
                                     102 213 70 155 210 156 27 68 84 72 64 221
                                     22 148 211 161 128 172 171 126 91 187 228
                                     64 174 4 164 17 217 231 86 3 223 241 74
                                     193 133 47 26 245 185 136 212 119 100 89
                                     57 183 169 146 27 181 246 70 134 112 116
                                     36 69 215 100 31 47 100 139 161 111 91 43
                                     125 202 198 97 180 135 226 190 191 17 17
                                     249 3 33 223 58 160 101 172 209 12 47 23
                                     136 31 165 182 144 207 174 222 21 209 68
                                     49 245 150 6 137 214 162 218 85 85 107 157
                                     160 123 112 252 55 145 166 242 116 82 27
                                     32 197 114 168 126 106 3 43 195 28 233 177
                                     67 228 126 232 22 41 25 27 177 37 13 108
                                     94 101 102 104 149 69 87 163 42 96 159 222
                                     250 122 162 168 62 101 11 113 147 121 149
                                     99 244 212 10 92 63 101 214 181 51 4 206
                                     205 86 130 42 36 254 229 93 210 60 109 107
                                     162 183 4 73 137 73 249 9 1 205 212 127
                                     148 191 139 120 1 37 81 72 133 56 205 97
                                     146 146 182 105 252 147 108 217 132 240
                                     235 57 255 67 35 232 52 67 1 32 181 18 150
                                     107 208 249 164 90 196 240 124 109 212 100
                                     74 85 79 212 125 78 55 234 219 81 223 130
                                     99 234 90 145 102 171 142 226 150 27 225
                                     14 39 27 154 52 180 132 31 109 122 183 245
                                     57 145 57 228 55 228 147 243 151 204 99
                                     109 171 243 53 20 58 183 108 178 79 166
                                     193 193 170 122 186 72 177 217 110 7 238
                                     145 80 42 62 74 61 183 136 183 219 163 118
                                     113 20 0 26 68 123 134 156 233 89 133 111
                                     249 105 84 6 26 50 171 119 236 229 204 89
                                     206 82 5 168 208 39 213 229 9 23 252 79
                                     194 247 101 82 39 190 247 85 251 184 251
                                     174 90 92 41 218 173 146 68 107 68 218 71
                                     194 101 0 74 1 105 63 206 63 54 8 27 19
                                     255 58 237 5 13 91 33 215 62 10 178 138
                                     133 26 104 42 70 91 121 254 101 108 117
                                     116 48 86 126 72 132 59 40 105 9 179 247
                                     132 59 52 29 29 151 129 228 70 172 130 73
                                     22 68 41 44 235 51 112 207 135 205 247 149
                                     131 211 231 75 217 27 170 140 69 41)))
   :AUTHENTICATOR #S(CERBERUS::ENCRYPTED-DATA
                     :TYPE :RC4-HMAC
                     :KVNO NIL
                     :CIPHER #(103 5 144 127 198 166 76 134 199 196 117 113 117
                               252 210 207 252 171 117 128 162 176 211 28 149
                               137 168 121 204 146 150 47 77 144 61 201 192 32
                               19 37 114 49 13 63 75 211 158 159 53 77 66 254
                               254 241 212 33 205 254 164 117 188 199 182 96
                               207 126 250 70 68 163 75 74 225 202 223 128 122
                               166 198 26 58 23 247 230 239 252 43 203 208 20
                               202 230 61 135 127 99 187 222 44 123 237 101 38
                               183 127 63 228 14 243 16 209 126 206 22 150 78
                               41 115 236 85 61 237 85 125 10 81 204 150 202 9
                               136 115 197 107 139 190 115 219 164 243 150 17
                               73 22 218 226 128 52 134 249 253 16 138 233 90
                               149 141 151 170 234 102 62 54 27 149 73 148 140
                               27 12 11 32 223 17 182 134 184 212 252 53 160
                               215 93 110 185 35 34 11 179 238 181 108 99 224
                               108 221 240 187 42 139 130 53 200 236 95 223 91
                               66 137 166 44 156 253 126 238 213 217 14 119 79
                               203 85 156 71 40 254 146 15 10 72 115 41 197 188
                               250 167 62 191 41 145 247 28 112 210 253 241 28
                               188 37 239 15 34 191 205 215 129 228 18 250 102
                               114 18 30 206 22 27 35 45 149 111 168 208 77 71
                               132 253 209 49 37 6 191 208 107 243 100 224 250
                               228 39 134 29 102 75 35 198 174 227 83 70 248
                               221 70 156 237 151 97 89 206 153 236 239 158 28
                               166 109 185 111 180 109 236 183 152 199 251 39
                               115 109 141 232 79)))
















;; accept context token
#(161 129 198 48 129 195 160  3 10  1  1 162 129 155  4 129 152
96 129 149  6  9 42 134 72 134 247 18  1  2  2  2  0
111 129 133 48 129 130 160  3  2  1  5 161  3  2  1 15
162 118 48 116 160  3  2  1 23 162 109  4 107 100 162 58
207 110 94 94 13 209 62 165 249 240 165 240 162 178 232 167
149 91 13 168 173 176 249 25 202 44 180 212 114 118 15 42
179 171 214 224 136 179 105 236 33 81 227 196 150 29 174 106
22 237 216 186 48 43 243 225 59 71 116 39 152 253 109 60
71 138 109 110 229 31 98 38 133 114 201 141  9 202 167  1
93 82 112 226 159 225 183 130 244 74 114 82 173 62 197 76
99 63 229 243 236 222 190 210 163 30  4 28  4  4  5 255
255 255 255 255  0  0  0  0 105 66 109 236 112 243 93 36
127 106 152 240 52 98 252 95)

;; nego-token-resp containing an AP-REP kerberos token (for mutual authentication)
;; and a MIC, which we don't yet understand. this doesn't matter too much because clients never have to send it
;; (unpack #'decode-nego-token *)

;; client: neg-token-init(incomplete, kerberos AP-REQ token)
;; server: neg-token-resp(incomplete, ???)
;; client: neg-token-resp(incomplete, kerberos AP-REQ token)
;; server: neg-token-resp(incomplete, kerberos AP-REP token, mic)
